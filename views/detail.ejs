<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - CatTV è§†é¢‘æ’­æ”¾</title>
    <link rel="icon" href="https://py.bpbpanel.ip-ddns.com/https://img.icons8.com/?size=100&id=111173&format=png&color=000000" type="image/png">
    <link rel="stylesheet" href="/assets/style.css">
</head>
<body>
    <div class="container">
        <div class="announcement-bar">
            <marquee behavior="scroll" direction="left">
                <span class="announcement-icon">ğŸ”Š</span> ä¸è¦ç›¸ä¿¡è§†é¢‘ä¸­ä»»ä½•å¹¿å‘Šï¼Œè°¨é˜²ä¸Šå½“ï¼
            </marquee>
        </div>
        
        <header class="header">
            <a href="/" class="logo-link">CatTV</a>
            <div class="header-actions">
                <span class="site-info"><%= sites.find(s => s.id === siteId).name %></span>
            </div>
        </header>
        
        <main class="main-content">
            <% if (playLinks.length > 0) { %>
                <div class="player-container">
                    <iframe 
                        class="video-player"
                        src="<%= playLinks[0].playUrl %>" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
                
                <div class="current-playing">
                    æ­£åœ¨æ’­æ”¾: <span class="playing-title"><%= playLinks[0].title %></span>
                    <span class="playing-site"><%= sites.find(s => s.id === siteId).name %></span>
                </div>
                
                <% if (playLinks.length > 1) { %>
                    <div class="episode-list">
                        <h3>æ’­æ”¾æºï¼š</h3>
                        <div class="episodes">
                            <% playLinks.forEach((link, index) => { %>
                                <a 
                                    href="javascript:void(0);" 
                                    class="episode <%= index === 0 ? 'active' : '' %>"
                                    data-playurl="<%= link.playUrl %>"
                                    data-title="<%= link.title %>"
                                >
                                    <%= link.title %>
                                </a>
                            <% }) %>
                        </div>
                    </div>
                <% } %>
            <% } else { %>
                <div class="no-player">
                    <p>æœªæ‰¾åˆ°å¯ç”¨çš„æ’­æ”¾æº</p>
                    <p>è¯·å°è¯•å…¶ä»–è§†é¢‘æˆ–ç«™ç‚¹</p>
                    <div class="no-player-actions">
                        <a href="/" class="action-button">è¿”å›é¦–é¡µ</a>
                    </div>
                </div>
            <% } %>
        </main>
        
        <footer class="footer">
            <p>Â© 2025 CatTV | å½“å‰è§†é¢‘: <%= title %> | ç«™ç‚¹: <%= sites.find(s => s.id === siteId).name %></p>
        </footer>
    </div>
    <script>
        // åˆ‡æ¢æ’­æ”¾æº
        document.querySelectorAll('.episode').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                
                // æ›´æ–°æ´»è·ƒçŠ¶æ€
                document.querySelectorAll('.episode').forEach(el => {
                    el.classList.remove('active');
                });
                item.classList.add('active');
                
                // æ›´æ–°æ’­æ”¾å™¨
                const player = document.querySelector('.video-player');
                player.src = item.dataset.playurl;
                
                // æ›´æ–°å½“å‰æ’­æ”¾æ ‡é¢˜
                const titleElement = document.querySelector('.playing-title');
                if (titleElement) {
                    titleElement.textContent = item.dataset.title;
                }
                
                // æ»šåŠ¨åˆ°æ’­æ”¾å™¨ä½ç½®
                player.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });
    </script>
</body>
</html>